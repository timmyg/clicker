{"version":3,"sources":["webpack:///./src/app/auth/auth.module.ts","webpack:///./src/app/auth/login/login.component.html","webpack:///./src/app/auth/login/login.component.scss","webpack:///./src/app/auth/login/login.component.ts"],"names":[],"mappings":"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","file":"default~profile-profile-module~tabs-tabs-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { LoginComponent } from './login/login.component';\nimport { IonicModule } from '@ionic/angular';\nimport { FormsModule } from '@angular/forms';\n\n@NgModule({\n  declarations: [LoginComponent],\n  imports: [CommonModule, IonicModule, FormsModule],\n  exports: [LoginComponent],\n})\nexport class AuthModule {}\n","module.exports = \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title> Login </ion-title>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button (click)=\\\"onCloseClick()\\\"> <ion-icon slot=\\\"icon-only\\\" name=\\\"close\\\"></ion-icon> </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-content padding>\\n  <form #phoneForm=\\\"ngForm\\\" (ngSubmit)=\\\"onPhoneSubmit(phoneForm.form)\\\" *ngIf=\\\"!codeSent\\\">\\n    <p class=\\\"ion-text-center\\\">Input your phone number below to login.</p>\\n    <section>\\n      <ion-input\\n        placeholder=\\\"Phone Number\\\"\\n        type=\\\"tel\\\"\\n        maxlength=\\\"10\\\"\\n        [(ngModel)]=\\\"phone\\\"\\n        name=\\\"phone\\\"\\n        [disabled]=\\\"waiting\\\"\\n      ></ion-input>\\n      <ion-button expand=\\\"block\\\" type=\\\"submit\\\" margin-top [disabled]=\\\"!phone || phone.length !== 10 || waiting\\\"\\n        >Next</ion-button\\n      >\\n      <p class=\\\"ion-text-center\\\"><em> Your number is only used for authentication and is never shared.</em></p>\\n    </section>\\n  </form>\\n  <form #codeForm=\\\"ngForm\\\" (ngSubmit)=\\\"onCodeSubmit()\\\" *ngIf=\\\"codeSent\\\">\\n    <p class=\\\"ion-text-center\\\">\\n      We have sent you an access code via text message for verification. Please enter it below.\\n    </p>\\n    <section>\\n      <ion-input\\n        placeholder=\\\"Code\\\"\\n        type=\\\"tel\\\"\\n        maxlength=\\\"8\\\"\\n        [(ngModel)]=\\\"code\\\"\\n        name=\\\"code\\\"\\n        [disabled]=\\\"waiting\\\"\\n      ></ion-input>\\n      <ion-button expand=\\\"block\\\" type=\\\"submit\\\" margin-top [disabled]=\\\"!isEligibleCode() || waiting\\\">Login</ion-button>\\n    </section>\\n  </form>\\n</ion-content>\\n\"","module.exports = \"ion-input {\\n  font-size: 40px;\\n  text-align: center; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy90aW1naWJsaW4vQ29kZS9jbGlja2VyL21vYmlsZS9hcHAvc3JjL2FwcC9hdXRoL2xvZ2luL2xvZ2luLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsZUFBZTtFQUNmLGtCQUFrQixFQUFBIiwiZmlsZSI6InNyYy9hcHAvYXV0aC9sb2dpbi9sb2dpbi5jb21wb25lbnQuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImlvbi1pbnB1dCB7XG4gIGZvbnQtc2l6ZTogNDBweDtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xufVxuIl19 */\"","import { Component } from '@angular/core';\nimport { ModalController, ToastController } from '@ionic/angular';\nimport auth0 from 'auth0-js';\nimport { environment } from 'src/environments/environment';\nimport { SegmentService } from 'ngx-segment-analytics';\nimport { Globals } from 'src/app/globals';\nconst auth = new auth0.WebAuth({\n  domain: environment.auth0.domain,\n  clientID: environment.auth0.clientId,\n  // redirectUri: `${window.location.origin}/tabs/profile/logging-in`,\n  redirectUri: `${environment.packageId}://${environment.auth0.domain}/cordova/${\n    environment.packageId\n  }/tabs/profile/logging-in`,\n  responseType: 'token id_token',\n});\n\n@Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.scss'],\n})\nexport class LoginComponent {\n  phone: string;\n  code: string;\n  codeSent: boolean;\n  waiting: boolean;\n\n  constructor(\n    public modalController: ModalController,\n    public toastController: ToastController,\n    private segment: SegmentService,\n    private globals: Globals,\n  ) {}\n\n  onCloseClick() {\n    this.modalController.dismiss();\n  }\n\n  async onPhoneSubmit() {\n    this.waiting = true;\n    auth.passwordlessStart(\n      {\n        connection: 'sms',\n        send: 'code',\n        phoneNumber: `+1${this.phone}`,\n      },\n      async (err, res) => {\n        if (err) {\n          const toastInvalid = await this.toastController.create({\n            message: err.description,\n            color: 'danger',\n            duration: 4000,\n            cssClass: 'ion-text-center',\n          });\n          toastInvalid.present();\n          this.waiting = false;\n          return console.error(err, JSON.stringify(window));\n        }\n        this.segment.track(this.globals.events.login.started);\n        this.codeSent = true;\n        this.waiting = false;\n      },\n    );\n  }\n\n  onCodeSubmit() {\n    this.waiting = true;\n    auth.passwordlessLogin(\n      {\n        connection: 'sms',\n        phoneNumber: `+1${this.phone}`.trim(),\n        verificationCode: this.code.toString(),\n      },\n      async (err, res) => {\n        if (err) {\n          const toastInvalid = await this.toastController.create({\n            message: err.code === 'access_denied' ? 'Invalid code' : err.description,\n            color: 'danger',\n            duration: 4000,\n            cssClass: 'ion-text-center',\n          });\n          toastInvalid.present();\n          this.waiting = false;\n          return console.error(err, JSON.stringify(window));\n        }\n        this.waiting = false;\n      },\n    );\n  }\n\n  isEligibleCode() {\n    return this.code && this.code.toString().length >= 4;\n  }\n}\n"],"sourceRoot":""}