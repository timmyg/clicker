<ion-card *ngIf="(reservation$ | async) as reservation">
  <!-- <ion-card-header>
    <ion-card-subtitle>{{ reservation.program.channelTitle }}</ion-card-subtitle>
    <ion-card-content>
      <ion-row>
        <ion-col size="1" no-padding align-items-center>
          <ion-icon
            *ngIf="reservation.program.type === 'basketball'"
            name="basketball"
            class="sport"
            size="large"
          ></ion-icon>
          <ion-icon
            *ngIf="reservation.program.type === 'football'"
            name="american-football"
            class="sport"
            size="large"
          ></ion-icon>
          <ion-icon
            *ngIf="reservation.program.type === 'baseball'"
            name="baseball"
            class="sport"
            size="large"
          ></ion-icon>
          <ion-icon *ngIf="reservation.program.type === 'soccer'" name="football" class="sport" size="large"></ion-icon>
        </ion-col>
        <ion-col> {{ reservation.program.title }}</ion-col>
      </ion-row>
    </ion-card-content>
  </ion-card-header> -->

  <ion-card-content>
    <ion-list id="length">
      <ion-radio-group (ionChange)="onLengthChange($event)">
        <ion-list-header *ngIf="!isEditMode"> Reservation Length </ion-list-header>
        <ion-list-header *ngIf="isEditMode"> Extend Reservation Length </ion-list-header>
        <ion-item *ngFor="let p of availablePlans">
          <ion-label flex ion-justify-items-end>
            <span>{{ p.title }}</span>
            <div flex ion-align-items-center float-right>
              <img class="coin ion-float-right" src="./assets/coin.svg" width="22" height="22" />
              <span padding-start>{{ p.tokens }}</span>
            </div>
          </ion-label>
          <ion-radio slot="start" value="{{ p.minutes }}" checked></ion-radio>
        </ion-item>
      </ion-radio-group>
    </ion-list>
    <p class="ion-text-center" padding-top>
      <!-- show always -->
      <span
        >You are tuning <b>TV {{ reservation.box.label || reservation.box.locationName }}</b> to
        <b>{{ reservation.program.channelTitle }} </b></span
      >
      <!-- show if new and reserving, or editing -->
      <span *ngIf="reservation.reserve || isEditMode; else oneTime">
        and reserving until <b>{{ reservationEnd$ | async | amDateFormat: 'h:mma' }}</b
        >. You will be able to freely change the channel during your reservation.
      </span>
      <!-- show when new and not reserving -->
      <ng-template #oneTime> <span *ngIf="!editMode">but others will be able to change the channel</span> </ng-template>
    </p>
    <ion-button
      color="success"
      size="large"
      expand="block"
      (click)="onConfirm(reservation)"
      slot="end"
      [disabled]="saving || !sufficientFunds"
      margin-top
      align-items-center
    >
      <ion-row *ngIf="!saving; else isSaving">
        <span>Confirm</span> <img class="coin" src="./assets/coin.svg" width="22" height="22" padding-start />
        <span>{{ reservation.cost }}</span>
      </ion-row>
      <ng-template #isSaving>
        Tuning
        <ion-spinner name="crescent" margin-start></ion-spinner>
      </ng-template>
    </ion-button>
    <ion-row class="ion-text-center" *ngIf="reservation.location && reservation.location.name">
      <p class="center">{{ reservation.location.name }} ({{ reservation.location.neighborhood }})</p></ion-row
    >
    <ion-row class="ion-text-center" *ngIf="!sufficientFunds" margin-top>
      <ion-text color="danger">
        Heads up! You only have {{ tokenCount }}
        <span *ngIf="tokenCount && tokenCount > 1; else singleToken">tokens</span
        ><ng-template #singleToken>token</ng-template> remaining. Please
        <span *ngIf="!isLoggedIn"><a [routerLink]="'/tabs/profile'">login</a> and </span>
        <a [routerLink]="'/tabs/profile'" *ngIf="isLoggedIn">add funds</a><span *ngIf="!isLoggedIn">add funds</span>.
      </ion-text>
    </ion-row>
  </ion-card-content>
</ion-card>
